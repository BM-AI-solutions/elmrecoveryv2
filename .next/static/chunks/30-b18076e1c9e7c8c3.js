(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{7030:function(e,r,s){Promise.resolve().then(s.bind(s,6925))},6925:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return AuthForm}});var a=s(6705),t=s(955),o=s(1396),l=s.n(o),i=s(4033),n=s(1865),m=s(8110),c=s(4578),d=s(7972),u=s(1981),x=s(5589),p=s(7368),h=s(1295),y=s(6264),f=s(8291),j=s(5925);s(5231),s(470);var g=s(1162),b=(0,g.$)("4b32a21c81275ac8f47c0a92cc517a69ae0413e1"),N=(0,g.$)("9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7");(0,g.$)("ad65725efcd8ccf0cebb30f018bb5d9f6750abbb");var w=(0,g.$)("3469b0c2fa054b913aa33b8e405de164aa4b2fe7");let v=c.z.object({email:c.z.string().email("Please enter a valid email address"),password:c.z.string().min(8,"Password must be at least 8 characters")}),F=c.z.object({fullName:c.z.string().min(2,"Please enter your full name"),email:c.z.string().email("Please enter a valid email address"),phone:c.z.string().min(10,"Please enter a valid phone number"),recoveryJourney:c.z.string().max(250,"Please keep your summary under 250 characters"),password:c.z.string().min(8,"Password must be at least 8 characters"),confirmPassword:c.z.string(),termsAccepted:c.z.boolean().refine(e=>!0===e,{message:"You must accept the terms and privacy policy"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),P=c.z.object({email:c.z.string().email("Please enter a valid email address")});function AuthForm(e){let{type:r}=e;(0,i.useRouter)(),(0,i.useSearchParams)();let[s,o]=(0,t.useState)(!1),[l,n]=(0,t.useState)(null);return"login"===r?(0,a.jsx)(LoginForm,{setFormError:n,formError:l,isLoading:s,setIsLoading:o}):"register"===r?(0,a.jsx)(RegisterForm,{setFormError:n,formError:l,isLoading:s,setIsLoading:o}):(0,a.jsx)(ResetPasswordForm,{setFormError:n,formError:l,isLoading:s,setIsLoading:o})}function LoginForm(e){let{formError:r,setFormError:s,isLoading:t,setIsLoading:o}=e;(0,i.useRouter)();let{register:c,handleSubmit:d,formState:{errors:u}}=(0,n.cI)({resolver:(0,m.F)(v)}),onSubmit=async e=>{o(!0),s(null);try{let r=new FormData;r.append("email",e.email),r.append("password",e.password);let a=await b(r);(null==a?void 0:a.error)&&(a.error.form?s(a.error.form):j.toast.error("Invalid email or password"))}catch(e){j.toast.error("An error occurred. Please try again."),console.error(e)}finally{o(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(FormHeader,{title:"Sign in to your account",description:"Access your client portal and application status"}),r&&(0,a.jsx)(FormErrorMessage,{message:r}),(0,a.jsxs)("form",{onSubmit:d(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(EmailField,{register:c,errors:u}),(0,a.jsx)(PasswordField,{register:c,errors:u,isLogin:!0}),(0,a.jsx)("div",{className:"flex items-center justify-end",children:(0,a.jsx)("div",{className:"text-sm",children:(0,a.jsx)(l(),{href:"/reset-password",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Forgot your password?"})})})]}),(0,a.jsx)(SubmitButton,{isLoading:t,text:"Sign in"}),(0,a.jsx)("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Don't have an account?"," ",(0,a.jsx)(l(),{href:"/register",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign up"})]})})]})]})}function RegisterForm(e){let{formError:r,setFormError:s,isLoading:t,setIsLoading:o}=e,c=(0,i.useRouter)(),{register:p,handleSubmit:h,formState:{errors:y}}=(0,n.cI)({resolver:(0,m.F)(F)}),onSubmit=async e=>{o(!0),s(null);try{let r=new FormData;r.append("fullName",e.fullName),r.append("email",e.email),r.append("phone",e.phone),r.append("recoveryJourney",e.recoveryJourney||""),r.append("password",e.password);let a=await N(r);(null==a?void 0:a.success)?(j.toast.success("Account created! Please check your email to verify your account."),c.push("/login")):(null==a?void 0:a.error)&&(a.error.form?s(a.error.form):j.toast.error("An error occurred. Please try again."))}catch(e){j.toast.error("An error occurred. Please try again."),console.error(e)}finally{o(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(FormHeader,{title:"Create your account",description:"Join Elm Recovery to begin your journey with us"}),r&&(0,a.jsx)(FormErrorMessage,{message:r}),(0,a.jsxs)("form",{onSubmit:h(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"fullName",type:"text",autoComplete:"name",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ".concat(y.fullName?"border-red-500":""),...p("fullName")})]}),y.fullName&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),y.fullName.message]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(d.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"phone",type:"tel",autoComplete:"tel",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ".concat(y.phone?"border-red-500":""),...p("phone")})]}),y.phone&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),y.phone.message]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"recoveryJourney",className:"block text-sm font-medium text-gray-700",children:"Your Recovery Journey (Optional)"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)("textarea",{id:"recoveryJourney",rows:3,className:"block w-full rounded-md border-gray-300 focus:border-primary-500 focus:ring-primary-500 ".concat(y.recoveryJourney?"border-red-500":""),placeholder:"Tell us a bit about your journey and what you're looking for...",...p("recoveryJourney")})}),y.recoveryJourney&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),y.recoveryJourney.message]})]}),(0,a.jsx)(EmailField,{register:p,errors:y}),(0,a.jsx)(PasswordField,{register:p,errors:y,isLogin:!1}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(x.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"confirmPassword",type:"password",autoComplete:"new-password",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ".concat(y.confirmPassword?"border-red-500":""),...p("confirmPassword")})]}),y.confirmPassword&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),y.confirmPassword.message]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"flex items-center h-5",children:(0,a.jsx)("input",{id:"termsAccepted",type:"checkbox",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded ".concat(y.termsAccepted?"border-red-500":""),...p("termsAccepted")})}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[(0,a.jsxs)("label",{htmlFor:"termsAccepted",className:"font-medium text-gray-700",children:["I agree to the"," ",(0,a.jsx)(l(),{href:"/terms",className:"text-primary-600 hover:text-primary-500",children:"Terms of Service"})," ","and"," ",(0,a.jsx)(l(),{href:"/privacy",className:"text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]}),y.termsAccepted&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),y.termsAccepted.message]})]})]})]}),(0,a.jsx)(SubmitButton,{isLoading:t,text:"Create account"}),(0,a.jsx)("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Already have an account?"," ",(0,a.jsx)(l(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign in"})]})})]})]})}function ResetPasswordForm(e){let{formError:r,setFormError:s,isLoading:t,setIsLoading:o}=e,c=(0,i.useRouter)(),{register:d,handleSubmit:u,formState:{errors:x}}=(0,n.cI)({resolver:(0,m.F)(P)}),onSubmit=async e=>{o(!0),s(null);try{let r=new FormData;r.append("email",e.email);let a=await w(r);(null==a?void 0:a.success)?(j.toast.success("Password reset email sent. Please check your inbox."),c.push("/login")):(null==a?void 0:a.error)&&(a.error.form?s(a.error.form):j.toast.error("An error occurred. Please try again."))}catch(e){j.toast.error("An error occurred. Please try again."),console.error(e)}finally{o(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(FormHeader,{title:"Reset your password",description:"We'll send you a link to reset your password"}),r&&(0,a.jsx)(FormErrorMessage,{message:r}),(0,a.jsxs)("form",{onSubmit:u(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)(EmailField,{register:d,errors:x})}),(0,a.jsx)(SubmitButton,{isLoading:t,text:"Send reset link"}),(0,a.jsx)("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Remember your password?"," ",(0,a.jsx)(l(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Back to sign in"})]})})]})]})}function FormHeader(e){let{title:r,description:s}=e;return(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(p.Z,{className:"h-12 w-12 text-primary-600"})}),(0,a.jsx)("h2",{className:"mt-4 text-3xl font-bold text-gray-900",children:r}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:s})]})}function FormErrorMessage(e){let{message:r}=e;return(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-md flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 mr-2"}),(0,a.jsx)("span",{children:r})]})}function EmailField(e){let{register:r,errors:s}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(h.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"email",type:"email",autoComplete:"email",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ".concat(s.email?"border-red-500":""),...r("email")})]}),s.email&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),s.email.message]})]})}function PasswordField(e){let{register:r,errors:s,isLogin:t}=e;return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(x.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{id:"password",type:"password",autoComplete:t?"current-password":"new-password",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ".concat(s.password?"border-red-500":""),...r("password")})]}),s.password&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 mr-1"}),s.password.message]})]})}function SubmitButton(e){let{isLoading:r,text:s}=e;return(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:r,className:"btn btn-primary w-full flex justify-center items-center",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[s,(0,a.jsx)(f.Z,{className:"ml-2 h-4 w-4"})]})})})}}}]);