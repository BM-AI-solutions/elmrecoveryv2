exports.id=546,exports.ids=[546],exports.modules={57399:(e,s,r)=>{let a={ad65725efcd8ccf0cebb30f018bb5d9f6750abbb:()=>Promise.resolve().then(r.bind(r,91183)).then(e=>e.signOut),"3469b0c2fa054b913aa33b8e405de164aa4b2fe7":()=>Promise.resolve().then(r.bind(r,91183)).then(e=>e.resetPassword),"4b32a21c81275ac8f47c0a92cc517a69ae0413e1":()=>Promise.resolve().then(r.bind(r,91183)).then(e=>e.signIn),"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7":()=>Promise.resolve().then(r.bind(r,91183)).then(e=>e.signUp)};async function endpoint(e,...s){let r=await a[e]();return r.apply(null,s)}e.exports={ad65725efcd8ccf0cebb30f018bb5d9f6750abbb:endpoint.bind(null,"ad65725efcd8ccf0cebb30f018bb5d9f6750abbb"),"3469b0c2fa054b913aa33b8e405de164aa4b2fe7":endpoint.bind(null,"3469b0c2fa054b913aa33b8e405de164aa4b2fe7"),"4b32a21c81275ac8f47c0a92cc517a69ae0413e1":endpoint.bind(null,"4b32a21c81275ac8f47c0a92cc517a69ae0413e1"),"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7":endpoint.bind(null,"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7")}},69377:(e,s,r)=>{Promise.resolve().then(r.bind(r,40899))},40899:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>AuthForm});var a=r(30784),t=r(9885),n=r(11440),l=r.n(n),c=r(57114),i=r(66558),o=r(83894),d=r(19098),m=r(69813),u=r(51831),p=r(93680),x=r(59490),f=r(23294),b=r(80087),h=r(37631),y=r(10345);r(95422),r(53009);var g=r(61324),w=(0,g.$)("4b32a21c81275ac8f47c0a92cc517a69ae0413e1"),j=(0,g.$)("9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7");(0,g.$)("ad65725efcd8ccf0cebb30f018bb5d9f6750abbb");var v=(0,g.$)("3469b0c2fa054b913aa33b8e405de164aa4b2fe7");let N=d.z.object({email:d.z.string().email("Please enter a valid email address"),password:d.z.string().min(8,"Password must be at least 8 characters")}),P=d.z.object({fullName:d.z.string().min(2,"Please enter your full name"),email:d.z.string().email("Please enter a valid email address"),phone:d.z.string().min(10,"Please enter a valid phone number"),recoveryJourney:d.z.string().max(250,"Please keep your summary under 250 characters"),password:d.z.string().min(8,"Password must be at least 8 characters"),confirmPassword:d.z.string(),termsAccepted:d.z.boolean().refine(e=>!0===e,{message:"You must accept the terms and privacy policy"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),S=d.z.object({email:d.z.string().email("Please enter a valid email address")});function AuthForm({type:e}){let s=(0,c.useRouter)();(0,c.useSearchParams)();let[r,n]=(0,t.useState)(!1),[d,g]=(0,t.useState)(null),A="login"===e?N:"register"===e?P:S,{register:k,handleSubmit:z,formState:{errors:F}}=(0,i.cI)({resolver:(0,o.F)(A)}),onSubmit=async r=>{n(!0),g(null);try{let a;if("login"===e){let e=new FormData;e.append("email",r.email),e.append("password",r.password),a=await w(e)}else if("register"===e){let e=new FormData;e.append("fullName",r.fullName),e.append("email",r.email),e.append("phone",r.phone),e.append("recoveryJourney",r.recoveryJourney||""),e.append("password",r.password),a=await j(e),a?.success&&(y.toast.success("Account created! Please check your email to verify your account."),s.push("/login"))}else if("reset-password"===e){let e=new FormData;e.append("email",r.email),a=await v(e),a?.success&&(y.toast.success("Password reset email sent. Please check your inbox."),s.push("/login"))}a?.error&&(a.error.form?g(a.error.form):y.toast.error("login"===e?"Invalid email or password":"An error occurred. Please try again."))}catch(e){y.toast.error("An error occurred. Please try again."),console.error(e)}finally{n(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx(m.Z,{className:"h-12 w-12 text-primary-600"})}),a.jsx("h2",{className:"mt-4 text-3xl font-bold text-gray-900",children:(()=>{switch(e){case"login":return"Sign in to your account";case"register":return"Create your account";case"reset-password":return"Reset your password"}})()}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:(()=>{switch(e){case"login":return"Access your client portal and application status";case"register":return"Join Elm Recovery to begin your journey with us";case"reset-password":return"We'll send you a link to reset your password"}})()})]}),d&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-md flex items-center",children:[a.jsx(u.Z,{className:"h-5 w-5 mr-2"}),a.jsx("span",{children:d})]}),(0,a.jsxs)("form",{onSubmit:z(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"space-y-4",children:["register"===e&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(p.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"fullName",type:"text",autoComplete:"name",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${F.fullName?"border-red-500":""}`,...k("fullName")})]}),F.fullName&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.fullName.message]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(p.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"phone",type:"tel",autoComplete:"tel",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${F.phone?"border-red-500":""}`,...k("phone")})]}),F.phone&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.phone.message]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"recoveryJourney",className:"block text-sm font-medium text-gray-700",children:"Your Recovery Journey (Optional)"}),a.jsx("div",{className:"mt-1",children:a.jsx("textarea",{id:"recoveryJourney",rows:3,className:`block w-full rounded-md border-gray-300 focus:border-primary-500 focus:ring-primary-500 ${F.recoveryJourney?"border-red-500":""}`,placeholder:"Tell us a bit about your journey and what you're looking for...",...k("recoveryJourney")})}),F.recoveryJourney&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.recoveryJourney.message]})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(x.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",type:"email",autoComplete:"email",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${F.email?"border-red-500":""}`,...k("email")})]}),F.email&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.email.message]})]}),("login"===e||"register"===e)&&(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(f.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:"password",autoComplete:"login"===e?"current-password":"new-password",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${F.password?"border-red-500":""}`,...k("password")})]}),F.password&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.password.message]})]}),"register"===e&&(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(f.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",type:"password",autoComplete:"new-password",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${F.confirmPassword?"border-red-500":""}`,...k("confirmPassword")})]}),F.confirmPassword&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.confirmPassword.message]})]}),"register"===e&&(0,a.jsxs)("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex items-center h-5",children:a.jsx("input",{id:"termsAccepted",type:"checkbox",className:`h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded ${F.termsAccepted?"border-red-500":""}`,...k("termsAccepted")})}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[(0,a.jsxs)("label",{htmlFor:"termsAccepted",className:"font-medium text-gray-700",children:["I agree to the"," ",a.jsx(l(),{href:"/terms",className:"text-primary-600 hover:text-primary-500",children:"Terms of Service"})," ","and"," ",a.jsx(l(),{href:"/privacy",className:"text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]}),F.termsAccepted&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),F.termsAccepted.message]})]})]}),"login"===e&&a.jsx("div",{className:"flex items-center justify-end",children:a.jsx("div",{className:"text-sm",children:a.jsx(l(),{href:"/reset-password",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Forgot your password?"})})})]}),a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:r,className:"btn btn-primary w-full flex justify-center items-center",children:r?(0,a.jsxs)(a.Fragment,{children:[a.jsx(b.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:["login"===e&&"Sign in","register"===e&&"Create account","reset-password"===e&&"Send reset link",a.jsx(h.Z,{className:"ml-2 h-4 w-4"})]})})}),(0,a.jsxs)("div",{className:"text-sm text-center mt-4",children:["login"===e&&(0,a.jsxs)("p",{className:"text-gray-600",children:["Don't have an account?"," ",a.jsx(l(),{href:"/register",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign up"})]}),"register"===e&&(0,a.jsxs)("p",{className:"text-gray-600",children:["Already have an account?"," ",a.jsx(l(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign in"})]}),"reset-password"===e&&(0,a.jsxs)("p",{className:"text-gray-600",children:["Remember your password?"," ",a.jsx(l(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Back to sign in"})]})]})]})]})}},82762:(e,s,r)=>{"use strict";r.d(s,{ZP:()=>i});var a=r(95153);let t=(0,a.createProxy)(String.raw`/home/project/components/auth/AuthForm.tsx`),{__esModule:n,$$typeof:l}=t,c=t.default,i=c},91183:(e,s,r)=>{"use strict";r.r(s),r.d(s,{resetPassword:()=>resetPassword,signIn:()=>signIn,signOut:()=>signOut,signUp:()=>signUp});var a=r(68065),t=r(35130),n=r(96042),l=r(67552),c=r(74292),i=r(28116);let o=c.z.object({email:c.z.string().email("Please enter a valid email address"),password:c.z.string().min(8,"Password must be at least 8 characters")}),d=c.z.object({fullName:c.z.string().min(2,"Please enter your full name"),email:c.z.string().email("Please enter a valid email address"),phone:c.z.string().min(10,"Please enter a valid phone number"),recoveryJourney:c.z.string().max(250,"Please keep your summary under 250 characters").optional(),password:c.z.string().min(8,"Password must be at least 8 characters")}),getSupabase=()=>{let e=(0,t.cookies)();return(0,l.createServerClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,{cookies:{get:s=>e.get(s)?.value,set(s,r,a){e.set({name:s,value:r,...a})},remove(s,r){e.set({name:s,value:"",...r})}}})};async function signIn(e){let s=e.get("email"),r=e.get("password"),a=o.safeParse({email:s,password:r});if(!a.success)return{error:{fieldErrors:a.error.flatten().fieldErrors}};let t=getSupabase(),{error:l}=await t.auth.signInWithPassword({email:s,password:r});if(l)return{error:{form:l.message}};(0,n.redirect)("/dashboard")}async function signUp(e){let s=e.get("fullName"),r=e.get("email"),a=e.get("phone"),t=e.get("recoveryJourney"),n=e.get("password"),l=d.safeParse({fullName:s,email:r,phone:a,recoveryJourney:t,password:n});if(!l.success)return{error:{fieldErrors:l.error.flatten().fieldErrors}};let c=getSupabase(),{error:i,data:o}=await c.auth.signUp({email:r,password:n,options:{data:{full_name:s,phone:a,recovery_journey:t}}});return i?{error:{form:i.message}}:{success:!0,email:r}}async function signOut(){let e=getSupabase();await e.auth.signOut(),(0,n.redirect)("/")}async function resetPassword(e){let s=e.get("email"),r=getSupabase(),{error:a}=await r.auth.resetPasswordForEmail(s,{redirectTo:`${process.env.NEXT_PUBLIC_SITE_URL}/reset-password/confirm`});return a?{error:{form:a.message}}:{success:!0}}(0,i.ensureServerEntryExports)([signIn,signUp,signOut,resetPassword]),(0,a.createActionProxy)("4b32a21c81275ac8f47c0a92cc517a69ae0413e1",null,signIn),(0,a.createActionProxy)("9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7",null,signUp),(0,a.createActionProxy)("ad65725efcd8ccf0cebb30f018bb5d9f6750abbb",null,signOut),(0,a.createActionProxy)("3469b0c2fa054b913aa33b8e405de164aa4b2fe7",null,resetPassword)}};