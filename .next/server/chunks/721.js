exports.id=721,exports.ids=[721],exports.modules={26189:(e,r,s)=>{let a={"3469b0c2fa054b913aa33b8e405de164aa4b2fe7":()=>Promise.resolve().then(s.bind(s,91183)).then(e=>e.resetPassword),"4b32a21c81275ac8f47c0a92cc517a69ae0413e1":()=>Promise.resolve().then(s.bind(s,91183)).then(e=>e.signIn),"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7":()=>Promise.resolve().then(s.bind(s,91183)).then(e=>e.signUp),ad65725efcd8ccf0cebb30f018bb5d9f6750abbb:()=>Promise.resolve().then(s.bind(s,91183)).then(e=>e.signOut)};async function endpoint(e,...r){let s=await a[e]();return s.apply(null,r)}e.exports={"3469b0c2fa054b913aa33b8e405de164aa4b2fe7":endpoint.bind(null,"3469b0c2fa054b913aa33b8e405de164aa4b2fe7"),"4b32a21c81275ac8f47c0a92cc517a69ae0413e1":endpoint.bind(null,"4b32a21c81275ac8f47c0a92cc517a69ae0413e1"),"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7":endpoint.bind(null,"9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7"),ad65725efcd8ccf0cebb30f018bb5d9f6750abbb:endpoint.bind(null,"ad65725efcd8ccf0cebb30f018bb5d9f6750abbb")}},69377:(e,r,s)=>{Promise.resolve().then(s.bind(s,40899))},40899:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>AuthForm});var a=s(30784),t=s(9885),o=s(11440),n=s.n(o),i=s(57114),l=s(66558),c=s(83894),m=s(19098),d=s(93680),u=s(51831),x=s(23294),p=s(69813),f=s(59490),b=s(80087),h=s(37631),g=s(10345);s(95422),s(53009);var y=s(61324),j=(0,y.$)("4b32a21c81275ac8f47c0a92cc517a69ae0413e1"),w=(0,y.$)("9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7");(0,y.$)("ad65725efcd8ccf0cebb30f018bb5d9f6750abbb");var v=(0,y.$)("3469b0c2fa054b913aa33b8e405de164aa4b2fe7");let N=m.z.object({email:m.z.string().email("Please enter a valid email address"),password:m.z.string().min(8,"Password must be at least 8 characters")}),P=m.z.object({fullName:m.z.string().min(2,"Please enter your full name"),email:m.z.string().email("Please enter a valid email address"),phone:m.z.string().min(10,"Please enter a valid phone number"),recoveryJourney:m.z.string().max(250,"Please keep your summary under 250 characters"),password:m.z.string().min(8,"Password must be at least 8 characters"),confirmPassword:m.z.string(),termsAccepted:m.z.boolean().refine(e=>!0===e,{message:"You must accept the terms and privacy policy"})}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),F=m.z.object({email:m.z.string().email("Please enter a valid email address")});function AuthForm({type:e}){(0,i.useRouter)(),(0,i.useSearchParams)();let[r,s]=(0,t.useState)(!1),[o,n]=(0,t.useState)(null);return"login"===e?a.jsx(LoginForm,{setFormError:n,formError:o,isLoading:r,setIsLoading:s}):"register"===e?a.jsx(RegisterForm,{setFormError:n,formError:o,isLoading:r,setIsLoading:s}):a.jsx(ResetPasswordForm,{setFormError:n,formError:o,isLoading:r,setIsLoading:s})}function LoginForm({formError:e,setFormError:r,isLoading:s,setIsLoading:t}){(0,i.useRouter)();let{register:o,handleSubmit:m,formState:{errors:d}}=(0,l.cI)({resolver:(0,c.F)(N)}),onSubmit=async e=>{t(!0),r(null);try{let s=new FormData;s.append("email",e.email),s.append("password",e.password);let a=await j(s);a?.error&&(a.error.form?r(a.error.form):g.toast.error("Invalid email or password"))}catch(e){g.toast.error("An error occurred. Please try again."),console.error(e)}finally{t(!1)}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(FormHeader,{title:"Sign in to your account",description:"Access your client portal and application status"}),e&&a.jsx(FormErrorMessage,{message:e}),(0,a.jsxs)("form",{onSubmit:m(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx(EmailField,{register:o,errors:d}),a.jsx(PasswordField,{register:o,errors:d,isLogin:!0}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx("div",{className:"text-sm",children:a.jsx(n(),{href:"/reset-password",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Forgot your password?"})})})]}),a.jsx(SubmitButton,{isLoading:s,text:"Sign in"}),a.jsx("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Don't have an account?"," ",a.jsx(n(),{href:"/register",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign up"})]})})]})]})}function RegisterForm({formError:e,setFormError:r,isLoading:s,setIsLoading:t}){let o=(0,i.useRouter)(),{register:m,handleSubmit:p,formState:{errors:f}}=(0,l.cI)({resolver:(0,c.F)(P)}),onSubmit=async e=>{t(!0),r(null);try{let s=new FormData;s.append("fullName",e.fullName),s.append("email",e.email),s.append("phone",e.phone),s.append("recoveryJourney",e.recoveryJourney||""),s.append("password",e.password);let a=await w(s);a?.success?(g.toast.success("Account created! Please check your email to verify your account."),o.push("/login")):a?.error&&(a.error.form?r(a.error.form):g.toast.error("An error occurred. Please try again."))}catch(e){g.toast.error("An error occurred. Please try again."),console.error(e)}finally{t(!1)}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(FormHeader,{title:"Create your account",description:"Join Elm Recovery to begin your journey with us"}),e&&a.jsx(FormErrorMessage,{message:e}),(0,a.jsxs)("form",{onSubmit:p(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(d.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"fullName",type:"text",autoComplete:"name",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${f.fullName?"border-red-500":""}`,...m("fullName")})]}),f.fullName&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),f.fullName.message]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(d.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"phone",type:"tel",autoComplete:"tel",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${f.phone?"border-red-500":""}`,...m("phone")})]}),f.phone&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),f.phone.message]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"recoveryJourney",className:"block text-sm font-medium text-gray-700",children:"Your Recovery Journey (Optional)"}),a.jsx("div",{className:"mt-1",children:a.jsx("textarea",{id:"recoveryJourney",rows:3,className:`block w-full rounded-md border-gray-300 focus:border-primary-500 focus:ring-primary-500 ${f.recoveryJourney?"border-red-500":""}`,placeholder:"Tell us a bit about your journey and what you're looking for...",...m("recoveryJourney")})}),f.recoveryJourney&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),f.recoveryJourney.message]})]}),a.jsx(EmailField,{register:m,errors:f}),a.jsx(PasswordField,{register:m,errors:f,isLogin:!1}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(x.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"confirmPassword",type:"password",autoComplete:"new-password",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${f.confirmPassword?"border-red-500":""}`,...m("confirmPassword")})]}),f.confirmPassword&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),f.confirmPassword.message]})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex items-center h-5",children:a.jsx("input",{id:"termsAccepted",type:"checkbox",className:`h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded ${f.termsAccepted?"border-red-500":""}`,...m("termsAccepted")})}),(0,a.jsxs)("div",{className:"ml-3 text-sm",children:[(0,a.jsxs)("label",{htmlFor:"termsAccepted",className:"font-medium text-gray-700",children:["I agree to the"," ",a.jsx(n(),{href:"/terms",className:"text-primary-600 hover:text-primary-500",children:"Terms of Service"})," ","and"," ",a.jsx(n(),{href:"/privacy",className:"text-primary-600 hover:text-primary-500",children:"Privacy Policy"})]}),f.termsAccepted&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),f.termsAccepted.message]})]})]})]}),a.jsx(SubmitButton,{isLoading:s,text:"Create account"}),a.jsx("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Already have an account?"," ",a.jsx(n(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Sign in"})]})})]})]})}function ResetPasswordForm({formError:e,setFormError:r,isLoading:s,setIsLoading:t}){let o=(0,i.useRouter)(),{register:m,handleSubmit:d,formState:{errors:u}}=(0,l.cI)({resolver:(0,c.F)(F)}),onSubmit=async e=>{t(!0),r(null);try{let s=new FormData;s.append("email",e.email);let a=await v(s);a?.success?(g.toast.success("Password reset email sent. Please check your inbox."),o.push("/login")):a?.error&&(a.error.form?r(a.error.form):g.toast.error("An error occurred. Please try again."))}catch(e){g.toast.error("An error occurred. Please try again."),console.error(e)}finally{t(!1)}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx(FormHeader,{title:"Reset your password",description:"We'll send you a link to reset your password"}),e&&a.jsx(FormErrorMessage,{message:e}),(0,a.jsxs)("form",{onSubmit:d(onSubmit),className:"mt-8 space-y-6 bg-white p-8 rounded-lg shadow",children:[a.jsx("div",{className:"space-y-4",children:a.jsx(EmailField,{register:m,errors:u})}),a.jsx(SubmitButton,{isLoading:s,text:"Send reset link"}),a.jsx("div",{className:"text-sm text-center mt-4",children:(0,a.jsxs)("p",{className:"text-gray-600",children:["Remember your password?"," ",a.jsx(n(),{href:"/login",className:"text-primary-600 hover:text-primary-500 font-medium",children:"Back to sign in"})]})})]})]})}function FormHeader({title:e,description:r}){return(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx(p.Z,{className:"h-12 w-12 text-primary-600"})}),a.jsx("h2",{className:"mt-4 text-3xl font-bold text-gray-900",children:e}),a.jsx("p",{className:"mt-2 text-sm text-gray-600",children:r})]})}function FormErrorMessage({message:e}){return(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 text-red-700 rounded-md flex items-center",children:[a.jsx(u.Z,{className:"h-5 w-5 mr-2"}),a.jsx("span",{children:e})]})}function EmailField({register:e,errors:r}){return(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(f.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"email",type:"email",autoComplete:"email",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${r.email?"border-red-500":""}`,...e("email")})]}),r.email&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),r.email.message]})]})}function PasswordField({register:e,errors:r,isLogin:s}){return(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(x.Z,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:"password",autoComplete:s?"current-password":"new-password",className:`block w-full rounded-md border-gray-300 pl-10 focus:border-primary-500 focus:ring-primary-500 ${r.password?"border-red-500":""}`,...e("password")})]}),r.password&&(0,a.jsxs)("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[a.jsx(u.Z,{className:"h-4 w-4 mr-1"}),r.password.message]})]})}function SubmitButton({isLoading:e,text:r}){return a.jsx("div",{children:a.jsx("button",{type:"submit",disabled:e,className:"btn btn-primary w-full flex justify-center items-center",children:e?(0,a.jsxs)(a.Fragment,{children:[a.jsx(b.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[r,a.jsx(h.Z,{className:"ml-2 h-4 w-4"})]})})})}},82762:(e,r,s)=>{"use strict";s.d(r,{ZP:()=>l});var a=s(95153);let t=(0,a.createProxy)(String.raw`/home/project/components/auth/AuthForm.tsx`),{__esModule:o,$$typeof:n}=t,i=t.default,l=i},91183:(e,r,s)=>{"use strict";s.r(r),s.d(r,{resetPassword:()=>resetPassword,signIn:()=>signIn,signOut:()=>signOut,signUp:()=>signUp});var a=s(68065),t=s(35130),o=s(96042),n=s(67552),i=s(74292),l=s(28116);let c=i.z.object({email:i.z.string().email("Please enter a valid email address"),password:i.z.string().min(8,"Password must be at least 8 characters")}),m=i.z.object({fullName:i.z.string().min(2,"Please enter your full name"),email:i.z.string().email("Please enter a valid email address"),phone:i.z.string().min(10,"Please enter a valid phone number"),recoveryJourney:i.z.string().max(250,"Please keep your summary under 250 characters").optional(),password:i.z.string().min(8,"Password must be at least 8 characters")}),getSupabase=()=>{let e=(0,t.cookies)();return(0,n.createServerComponentClient)({cookies:()=>e})};async function signIn(e){let r=e.get("email"),s=e.get("password"),a=c.safeParse({email:r,password:s});if(!a.success)return{error:{fieldErrors:a.error.flatten().fieldErrors}};let t=getSupabase(),{error:n}=await t.auth.signInWithPassword({email:r,password:s});if(n)return{error:{form:n.message}};(0,o.redirect)("/dashboard")}async function signUp(e){let r=e.get("fullName"),s=e.get("email"),a=e.get("phone"),t=e.get("recoveryJourney"),o=e.get("password"),n=m.safeParse({fullName:r,email:s,phone:a,recoveryJourney:t,password:o});if(!n.success)return{error:{fieldErrors:n.error.flatten().fieldErrors}};let i=getSupabase(),{error:l,data:c}=await i.auth.signUp({email:s,password:o,options:{data:{full_name:r,phone:a,recovery_journey:t}}});return l?{error:{form:l.message}}:{success:!0,email:s}}async function signOut(){let e=getSupabase();await e.auth.signOut(),(0,o.redirect)("/")}async function resetPassword(e){let r=e.get("email"),s=getSupabase(),{error:a}=await s.auth.resetPasswordForEmail(r,{redirectTo:`${process.env.NEXT_PUBLIC_SITE_URL}/reset-password/confirm`});return a?{error:{form:a.message}}:{success:!0}}(0,l.ensureServerEntryExports)([signIn,signUp,signOut,resetPassword]),(0,a.createActionProxy)("4b32a21c81275ac8f47c0a92cc517a69ae0413e1",null,signIn),(0,a.createActionProxy)("9d4fe9d1534caae0c5ab7c7d90c82c156a4ba8e7",null,signUp),(0,a.createActionProxy)("ad65725efcd8ccf0cebb30f018bb5d9f6750abbb",null,signOut),(0,a.createActionProxy)("3469b0c2fa054b913aa33b8e405de164aa4b2fe7",null,resetPassword)}};